containers:
  default:
    docker: gcr.io/shopify-docker-images/apps/production/web-platform-ci-node:10.18.0-yarn-1.21.1

steps:
  - build-polaris:
    label: 'Build polaris'
    timeout: 5m
    run:
      - yarn: ~
      - ./.shopify-build/build-and-upload-to-gcp.sh
  - wait: ~
  - build-web:
    label: 'Build polaris'
    trigger: 'web-polaris-builder'
    build:
      branch: add-polaris-build-pipeline
      env:
        POLARIS_ARTIFACT_FILENAME: 'shopify-polaris-${BUILDKITE_COMMIT}.tgz'
